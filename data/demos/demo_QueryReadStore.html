<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
	<title>Dojox QueryReadStore+grid Demo</title>
	<style type="text/css">
		@import "../../../dijit/themes/tundra/tundra.css";
		@import "../../../dojo/resources/dojo.css";
		@import "../../../dijit/tests/css/dijitTests.css";
		/* BE SURE TO NEVER FORGET IMPORTING THE GRID's CSS, or you will wonder why the grid looks so strange (or even think that it doesnt work) */
		@import "../../../dojox/grid/_grid/tundraGrid.css";
	</style>


	<script type="text/javascript" src="../../../dojo/dojo.js" djConfig="isDebug:true, parseOnLoad: true"></script>
	<script type="text/javascript">
		dojo.require("dojo.parser"); // scan page for widgets and instantiate them
		dojo.require("dojox.grid.Grid");
		dojo.require("dojox.grid._data.model"); // dojox.grid.data.DojoData is in there
		dojo.require("dojox.data.QueryReadStore");
		var gridLayout = [
			{
				cells: [[
					{
						name: "row #",
						width:5,
						styles: "text-align:right;",
						get:function(inRowIndex) { return inRowIndex+1;} // this auto generates a row num
					} 
					,{
						name: "id",
						field: "id",
						styles: "text-align:right;",
						width:5
					} 
					,{
						name: "Name",
						field: "name",
						width:20
						//formatter: rs.chunk.adminUser.grid.formatUser
					}
					,{
						name: "Label",
						width:20,
						//styles: "text-align:right;",
						field: "label"
						//formatter: phpr.grid.formatDate
					}
					,{
						name: "Abbrev.",
						width:5,
						//styles: "text-align:right;",
						field: "abbreviation"
						//formatter: phpr.grid.formatDate
					}
				]]
			}
		];
		
	</script>
</head>
<body class="tundra">

	<h1 class="testTitle">Dojox QueryReadStore + Grid demo - simplest</h1>
	Using with the grid - simple/stupid version, just load one page, no paging, no sorting<br />
	For some reason using less than 30 rows (rowsPerPage=30) on the grid makes the grid issue two requests for initially showing the grid.
	So we have set the rowsPerPage to 30.<br />
	You can see that data are loaded upon demand by scrolling down in the grid below line #30,
	open FireBug and you see a server request being issued, to retreive another 30 rows/items.<br />
	<b>Sorting does not work</b>, dont get confused, even though you can click on the header and it seems to sort, its only
	doing client data sort for the chunk (30 items) last loaded!!!
 
	<h2>The store and grid are "generated" and connected in HTML, only the structure is defined in JS</h2>
	<b>Capabilities:</b> load data from server, show data, paging (30 rows at a time), <span style="text-decoration:line-through;">sort, filter</span>
	<div dojoType="dojox.data.QueryReadStore" jsId="store1" url="../tests/stores/QueryReadStore.php" requestMethod="post" doClientPaging="false"></div>
	<div dojoType="dojox.grid.data.DojoData" jsId="model1" store="store1" rowsPerPage="30"></div>
	<div id="grid1" dojoType="dojox.Grid" model="model1" structure="gridLayout" style="height:300px; width:800px;"></div>

	<h2>The grid is in HTML, store, model, etc. are created and connected via JS (like above just using JS)</h2>
	<b>Capabilities:</b> load data from server, show data, paging (30 rows at a time), <span style="text-decoration:line-through;">sort, filter</span>
	<div id="grid2" dojoType="dojox.Grid" style="height:300px; width:800px;"></div>
	<script>
		// Connect the model and store AFTER the page is loaded, since we can only access
		// the widget then, since it will be created just before dojo.addOnLoad() is called.
		dojo.addOnLoad(function() {
			// Instanciate the store, pass it to the model, connect them to the grid and add the layout ... just some hand work :-)
			var store = new dojox.data.QueryReadStore({url:"../../data/tests/stores/QueryReadStore.php", requestMethod:"post", doClientPaging:false});
			var model = new dojox.grid.data.DojoData(null, null, {store:store, rowsPerPage:30});
			var w = dijit.byId("grid2");
			w.setModel(model);
			w.setStructure(gridLayout);
		});
	</script>

</body>
</html>
