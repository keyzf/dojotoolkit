<html>
	<head>
		<title>clocking fun</title>
		<style type="text/css">
			@import "../../../dojo/resources/dojo.css";
		</style>
		<script type="text/javascript" src="../../../dojo/dojo.js" djConfig="isDebug:true"></script>
		<script type="text/javascript" src="../functional.js"></script>
		<script type="text/javascript" src="../functional/sequence.js"></script>
		<script type="text/javascript" src="../functional/fold.js"></script>
		<script type="text/javascript">
			dojo.addOnLoad(function(){
				var LEN = 1000, ITER = 100, SUM = (LEN - 1) * LEN / 2, b, e;
				var foldl_1 = function(/*Array*/ a, /*Function*/ f, /*Object*/ z){
					for(var i = 0; i < a.length; z = f.call(dojo.global, z, a[i++]));
					return z;
				};
				var foldl_2 = function(/*Array*/ a, /*Function*/ f, /*Object*/ z){
					dojo.forEach(a, function(x){ z = f.call(dojo.global, z, x); });
					return z;
				};
				var foldl_3 = function(/*Array*/ a, /*Function*/ f, /*Object*/ z){
					a.forEach(function(x){ z = f.call(dojo.global, z, x); });
					return z;
				};
				var sample = dojox.lang.functional.repeat(LEN, function(x){ return x + 1; }, 0);
				b = new Date();
				for(var i = 0; i < ITER; ++i){
					var t = dojox.lang.functional.foldl(sample, function(a, b){ return a + b; }, 0);
					console.assert(t == SUM);
				}
				e = new Date();
				console.log("dojox.lang.functional.foldl:", e.getTime() - b.getTime());
				b = new Date();
				for(var i = 0; i < ITER; ++i){
					var t = dojox.lang.functional.reduce(sample, function(a, b){ return a + b; });
					console.assert(t == SUM);
				}
				e = new Date();
				console.log("dojox.lang.functional.reduce:", e.getTime() - b.getTime());
				b = new Date();
				for(var i = 0; i < ITER; ++i){
					var t = foldl_1(sample, function(a, b){ return a + b; }, 0);
					console.assert(t == SUM);
				}
				e = new Date();
				console.log("raw loop:", e.getTime() - b.getTime());
				b = new Date();
				for(var i = 0; i < ITER; ++i){
					var t = foldl_2(sample, function(a, b){ return a + b; }, 0);
					console.assert(t == SUM);
				}
				e = new Date();
				console.log("dojo.forEach:", e.getTime() - b.getTime());
				if(sample.forEach){
					b = new Date();
					for(var i = 0; i < ITER; ++i){
						var t = foldl_3(sample, function(a, b){ return a + b; }, 0);
						console.assert(t == SUM);
					}
					e = new Date();
					console.log("Array.forEach:", e.getTime() - b.getTime());
				}
			});
		</script>
	</head>
	<body>
		<p>This test is meant to run with Firebug.</p>
	</body>
</html>
