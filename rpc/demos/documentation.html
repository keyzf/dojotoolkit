<html>
	<head>
		<script src="../../../dojo/dojo.js" djConfig="parseOnLoad: true"></script>
		<script>
			dojo.require("dojo.io.script")
			dojo.require("dojox.rpc.Service");
			dojo.require("dijit._Widget");
			dojo.require("dojox.dtl._Templated");
			dojo.require("dojo.parser");

			dojo.declare("API", [dijit._Widget, dojox.dtl._Templated], {
				constructor: function(params, node){
					this.jsonp = new dojox.rpc.Service(dojo.moduleUrl("dojox.rpc", "documentation.smd"));
				},
				onSearch: function(e){
					if(e.keyCode == dojo.keys.ENTER){
						this.jsonp.get({
							name: e.target.value
						}).addCallback(this, function(results){
							console.debug(results);
							this.results = results;
							this.render();
						});
					}
				},
				templateString: '<div><input dojotAttachPoint="search" dojoAttachEvent="onkeyup: onSearch"><ul>{% for result in results %}<li>{% if result.type %}<i>{{ result.type }}</i> {% endif %}{% ifequal result.type "Function" %}{% if not result.resources %}function {% endif %}{% endifequal %}{{ result.name }}{% ifequal result.type "Function" %}{% if not result.resources %}({% for parameter in result.parameters %}{% if not forloop.first %}, {% endif %}{% if parameter.type %}<i>{{ parameter.type }}{% if parameter.optional %}?{% endif %}{% if parameter.repeating %}...{% endif %}</i> {% endif %}{{ parameter.name }}{% endfor %}{% endif %}{% endifequal %}{% ifequal result.type "Function" %}{% if not result.resources %}){% endif %}{% endifequal %}</li>{% endfor %}</ul></div>'
			});
		</script>
	</head>
	<body>
		<div dojoType="API"></div>
	</body>
</html>